{% import 'components/macros.html' as ui %}
<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Dental Tourism CRM{% endblock %}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/app.css') }}" rel="stylesheet">
</head>
<body>
<div class="app-shell">
  <aside class="sidebar">
    <div class="brand">SmileFlow CRM</div>
    {% if current_user.is_authenticated %}
      <a class="nav-link" href="{{ url_for('dashboard.index') }}">Dashboard</a>
      <a class="nav-link" href="{{ url_for('leads.list_leads') }}">Leads</a>
      <a class="nav-link" href="{{ url_for('patients.list_patients') }}">Patients</a>
      <a class="nav-link" href="{{ url_for('quotes.list_quotes') }}">Quotes</a>
      <a class="nav-link" href="{{ url_for('payments.list_payments') }}">Payments</a>
      <a class="nav-link" href="{{ url_for('communications.inbox') }}">Inbox</a>
      <a class="nav-link" href="{{ url_for('communications.queue') }}">Call Queue</a>
      <a class="nav-link" href="{{ url_for('reports.index') }}">Reports</a>
      {% if current_user.role == 'admin' %}
        <a class="nav-link" href="{{ url_for('users.list_users') }}">Team</a>
        <a class="nav-link" href="{{ url_for('settings.clinic_profile') }}">Settings</a>
        <a class="nav-link" href="{{ url_for('integrations.index') }}">Integrations</a>
      {% endif %}
      <a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
    {% else %}
      <a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
    {% endif %}
  </aside>

  <div class="content-wrap">
    <div class="topbar">
      <div>
        {% if current_user.is_authenticated %}
          <strong>{{ current_user.clinic.name }}</strong>
          <span class="text-muted"> | {{ current_user.full_name }} ({{ current_user.role }})</span>
        {% endif %}
      </div>
      <button class="btn btn-secondary" onclick="toggleTheme()">Theme</button>
    </div>

    <main class="page">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="row-gap" style="margin-bottom:14px;">
            {% for category, message in messages %}
              <div class="card">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </main>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
